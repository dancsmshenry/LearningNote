# 网络基础

MAC地址，IP地址，端口

- MAC地址：用于标识网络设备，表示网卡的id，理论上唯一的，表示主机的物理地址
  - 表示网卡的id，理论上是唯一的
  - mac地址一般用来表示主机的id，这个id是物理地址不会改变
- 网卡：网络适配器或网络接口卡NIC，通过网卡能够使不同的计算机之间连接，从而完成数据通信等功能（理论上是全球唯一的）
- linux下 ifconfig查看网卡地址
- ip地址
  - 是一种internet上的主机编址方式，也称为网际协议地址
  - 组成：使用32bit，由子网ID、主机ID两部分组成
  - 子网ID：IP地址中由子网掩码中1覆盖的连续位
  - 主机ID：IP地址中由子网掩码中0覆盖的连续位
  - 是表示主机的id，这个id是虚拟的，会改变的
  - ipv4（4个bit，32位），ipv6（）
  - 子网ID不同的网络不能直接通信，要用路由器转发
  - 主机id全部为0的IP地址表示网段地址
  - 主机id全为1的IP地址表示该网段的广播地址
  - 回环地址：127.0.0.1-127.255.255.254
  - 子网掩码：前面是连续的1，后面是连续的0
- 端口
  - 作用：用来表示应用程序（进程）
  - port：2个字节 0-65535 0-1023知名端口 自定义端口 1024-65535
  - 为什么有了pid，还需要用端口来表示一个进程（pid是会一直变化的....）
  - 一个端口不可以被多个程序使用，一个应用程序可以占用多个端口
  - 一个服务端的端口可以被多个客户端访问
- OSI参考模型
  - 应用层，表示层，会话层，传输层，网络层，数据链路层，物理层
- TCP/IP模型
  - 应用层，传输层，网络层，网络接口层



物理层

- 主要定义物理设备标准，如网线的接口类型、光纤的接口类型，各种传输介质的传输速率等。主要作用是传输比特流，这一层的数据叫做比特



数据链路层

- 定义了如何让格式化数据以帧为单位进行传输、以及如何让控制对物理介质的访问。这一层通常还提供错误检测和纠正，以确保数据的可靠传输
- 通过mac地址负责收发数据



网络层

- 在位于不同地理位置的网络中的两个主机系统之间提供连接和路径选择
- ip 给两台主机提供路径选择



传输层

- port 区分数据递送到哪一个应用程序



会话层

- 建立连接



表示层

- 解码



TCP/IP网络协议栈

- 应用层（应用程序，FTP，telnet,tftp,nfs）
- 传输层（进程到进程，tcp,udp）
- 网络层（主机到主机ip,icmp,igmp）
- 链路层（设备到设备，p，rarp）



udp报文首部

- 16位源端口：发送方端口号
- 16位目的端口：接收方端口号
- 16位长度：UDP用户数据包的长度，最小值为8（仅有首部）
- 16位校验和：检测UDP用户数据包在传输中是否有错，有错就丢弃



tcp报文首部

- 源端口号，目的端口号
- 序列号，确认号
- 头部长度，保留（6位），URG，ACK，PSH，RST，SYN，FIN
- 窗口尺寸（16位）
- TCP校验和（16位），紧急指针（16位）
- 选项（32位）



IP报头

- 源ip地址，目的ip地址
- ttl生存时间
  - 如果不设置ttl，在网络断开的情况下，数据包就会不断的在路由之间来回传递，最后造成线路阻塞
- 协议类型，头部校验和，片偏移，总长度，服务类型，首部长度



mac头部

- 目的地址，源地址，类型，数据
- 类型：0800 ip数据包
  - 0806 arp数据包
  - 8035 rarp数据包



局域网内用udp??效率高



arp协议：ip地址转换为mac地址





### BS和CS模型对比

- ![](BS和CS模式的区别.png)
- CS模型
  - 优点：缓存大量数据，协议选择灵活，速度快
  - 缺点：安全性（质疑平台的安全性），开发工作量较大
- BS模型
  - 优点：安全性，跨平台
  - 缺点：不能缓存大量数据，严格遵守HTTP



### 通信时序与代码的对应关系

- ![](通信时序与代码的对应关系.png)
