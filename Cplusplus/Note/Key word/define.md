# define

### 与函数相比

- 运行时
  - 宏在编译时完成替换，之后被替换的文本参与编译，相当于直接插入了代码，运行时不存在函数调用，执行起来更快
  - 函数调用在运行时需要跳转到具体调用函数
- 返回值
  - 宏定义属于在结构中插入代码，没有返回值
  - 函数调用具有返回值
- 类型
  - 宏定义参数没有类型，不进行类型检查
  - 函数参数具有类型，需要检查类型



### 与const相比

- 运行时
  - 宏定义是在编译的预处理阶段起作用
  - const 是在编译、运行的时候起作用
- 数据类型
  - 宏定义的只是个常数不带类型，宏定义只做替换，不做类型检查和计算（无需内存空间）
  - const 常量有数据类型，编译器可以对其进行类型安全检查（要内存空间）
- 其他1
  - 宏定义是将宏名称进行替换，在内存中会产生多分相同的备份
  - const 在程序运行中只有一份备份，且可以执行常量折叠，能将复杂的的表达式计算出结果放入常量表
- 其他2
  - defind处理后，占用代码段空间
  - const占用数据段空间

- 其他3
  - const不能重定义
  - define可以通过#undef取消某个符号的定义，进行重定义




### 与typedef相比

- 用途

  - 宏主要用于定义常量及书写复杂的内容
  - typedef主要用于定义类型别名

- 运行时

  - 宏替换发生在编译阶段之前，属于文本插入替换
  - typedef是编译的一部分

- 类型

  -  宏不检查类型
  - typedef会检查数据类型

- 写法

  - 宏不是语句，不在在最后加分号
  - typedef是语句，要加分号标识结束

- 作用域

  - 宏没有作用域的限制，只要是之前预定义过的宏，在以后的程序中都可以使用
  - typedef 有自己的作用域

- 功能

  - typedef用来定义类型的别名，定义与平台无关的输局结构
  - define不只是可以为类型取别名，还可以定义常量、变量、编译开关等

- 坑爹

  - ```cpp
    #define pstr2 char*;//将代码中的pstr2变为char*，但是会有很大的问题
    pstr2 c1, c2;
    char *c1, c2;//上面一句话就等价于这个了.....
    
    typedef char* pstr3;
    pstr3 c1, c2;
    char *c1, *c2;//上面一句话等价于这个
    ```

  - https://blog.csdn.net/liitdar/article/details/80069638



### 与inline相比

- \#define是关键字，inline是函数
- 宏定义在预处理阶段进行文本替换，inline函数在编译阶段进行替换
- inline函数有类型检查，相比宏定义比较安全





# 常用技巧



### while

- ```cpp
  #define func(a) \
  	do {		\
  		a = a + 10; \
  		a /= 19; \ 
  	} while (0)
  ```

- 防止编译错误或语义错误（比如说if语句要调用func(a)，如果没有这个循环的话，可能if只会执行a=a+10;这一句）



### 用宏实现一个max
