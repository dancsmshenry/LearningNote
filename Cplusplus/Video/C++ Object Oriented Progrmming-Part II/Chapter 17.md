# 关于vptr和vtbl

- 带有虚函数就会有虚指针

- 有关继承：继承只会继承下数据，继承下函数的调用权

- 有虚函数的类会有一个虚指针（virtual point），该指针指向一个虚函数表（virtual table），虚函数表上记录着虚函数的地址

- 这个指针一般会放到对象空间的第一位，一般占用4个字节

- 静态绑定：根据代码，把它编译成指定的命令，然后执行

- 动态绑定：通过指向对象的指针或对象本身，找到虚函数指针，再通过指针指向的虚函数表，找到确定要用到的那个函数的地址，最后根据地址去调用函数

  - ```cpp
    //其中p是一个指向对象的指针，vptr是对象内部的虚函数指针，n是要找的函数的位置
    //也要看p最后指到的是谁，正是因为指到的不同才导致了多态
    (*(p->vptr)[n])(p);
    ```

  - 三个条件：指针调用，向上转型，调用虚函数

- 多态的造成